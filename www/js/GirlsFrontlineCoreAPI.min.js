let GirlsFrontlineCoreAPI=function(){const e=["hg","smg","rf","ar","mg","sg"];let l=!1,o="",t="",i=[];$("#tdoll_selection").on("change",(function(){let e=this.value;""!==e&&d(parseInt(e))})),$("#btns_doll_type").children().on("click",(function(){let e=$(this).data("type");$(this).siblings().addBack().removeClass("active"),$(this).addClass("active"),a(e.toLowerCase()),c()})),$("#btnFloat_favorite").on("click",(function(){let e=$("#tdoll_selection").val();null!==e?u(parseInt(e)):console.error("Favorite Button: "+e+" is NaN!")})),$("#tdoll_selection_favorite").on("change",(function(){let e=this.value;""!==e&&d(parseInt(e),!0)})),$("#btns_favorite").children().on("click",(function(){let e=$(this).data("type");$(this).siblings().addBack().removeClass("active"),$(this).addClass("active"),a(e.toLowerCase(),!0),c(!0)})),$("#btnFloat_Unfavorite").on("click",(function(){let e=$("#tdoll_selection_favorite").val();null!==e?f(parseInt(e)):console.error("UnFavorite Button: "+e+" is NaN!")})),$("#tdoll_BuildTime").on("click",(function(){MaterialDateTimePicker.showTimePicker()})),$("#tdoll_selection_BuildTime").on("change",(function(){let e=this.value;""!==e&&d(parseInt(e),void 0,!0)}));let n=function(){$.getScript("https://unpkg.com/girlsfrontline-core/umd/gfcore.min.js").done((function(e,o,t){console.log("GirlsFrontlineCore-API loaded successfully: ",t.status+" - "+o),l=!0,console.log("Loaded - done: loaded_dynamically = ",l),$("#GFLC_API_Loaded").html("<b>GFL-Core API: </b>Loaded"),NetworkState.close_modal(),_init()})).fail((function(e,o,t){console.error("GirlsFrontlineCore-Api failed to load: ",e.status+" - "+t),l=!1,console.log("Loaded - fail: loaded_dynamically = ",l),$("#GFLC_API_Loaded").html("<b>GFL-Core API: </b> "+t)}))},a=function(l="hg",n=!1){try{if(e.includes(l)){let e=[];gfcore.dolls.forEach((function(a){switch(n){case!0:t=l,a.type===l&&i.includes(a.id)&&e.push([a.id,a.codename]);break;default:o=l,a.type===l&&e.push([a.id,a.codename])}})),s(e,n)}}catch(e){console.error("get_dolls_by_type: Failed:",e)}},s=function(e,l=!1,o=!1){let t="";t=!0===l?"#tdoll_selection_favorite":!0===o?"#tdoll_selection_BuildTime":"#tdoll_selection",$(t).empty().append("<option value='' disabled selected>Choose a T-Doll</option>"),e.forEach((function(e){$(t).append("<option value='"+e[0]+"'>"+e[1]+"</option>")})),$("select").formSelect()},d=function(e,l=!1,o=!1){let t=gfcore.dolls.find((({id:l})=>l===e));BuildTimeOBJ=new Date(1e3*t.buildTime),hours=BuildTimeOBJ.getUTCHours(),minutes=BuildTimeOBJ.getUTCMinutes(),seconds=BuildTimeOBJ.getSeconds(),BuildTimeString=hours.toString().padStart(2,"0")+":"+minutes.toString().padStart(2,"0")+":"+seconds.toString().padStart(2,"0");let i=`\n            <b>Name: </b>${t.codename}<br>\n            <b>ID: </b>${t.id}<br>\n            <b>Type: </b>${t.type.toUpperCase()}<br>\n            <b>Rank: </b>${"&#9734;".repeat(t.rank)}<br>\n            <b>BuildTime: </b>${BuildTimeString}<br>\n            <b>Skins: </b>${t.skins.length}\n        `;!0===l?$("#Doll_Data_favorite").html(i):!0===o?$("#Doll_Data_BuildTime").html(i):$("#Doll_Data").html(i)},c=function(e=!1,l=!1){let o="\n            <b>Name: </b>No Data<br>\n            <b>ID: </b>No Data<br>\n            <b>Type: </b>No Data<br>\n            <b>Rank: </b>No Data<br>\n            <b>BuildTime: </b>No Data<br>\n            <b>Skins: </b>No Data\n        ";!0===e?$("#Doll_Data_favorite").html(o):!0===l?$("#Doll_Data_BuildTime").html(o):$("#Doll_Data").html(o)},r=function(){console.log("Save Favorited T-Dolls to Local Storage"),localStorage.setItem("favorite_doll_ids",JSON.stringify(i))},u=function(e){i.includes(e)?M.toast({html:"T-Doll already Favorited",displayLength:2e3,classes:"grey_gfl"}):(i.push(e),r(),a(t,!0),M.toast({html:"T-Doll Favorited",displayLength:2e3,classes:"grey_gfl"}))},f=function(e){if(confirm("Remove this T-Doll?")){for(let l=0;l<i.length;l++)i[l]===e&&i.splice(l,1);r(),a(t,!0),c(!0),M.toast({html:"T-Doll removed from Favorites",displayLength:2e3,classes:"grey_gfl"})}};return{init:function(){let e=localStorage.getItem("favorite_doll_ids");null!==e&&(i=[],i=JSON.parse(e)),a(),a(void 0,!0)},get_loaded_dynamically:function(){return n(),l},example:function(){const e=gfcore.dolls.find((({codename:e})=>"G36"===e));e.level=70,e.dummyLink=3,e.favor=50,console.log("Doll G36: ",e.stats),e.skins.forEach((function(e){console.log(e.name)}));const l=gfcore.equips.find((({buildTime:e})=>2100===e));console.log("Equipment BT = 2100: ",l.stats);const o=gfcore.fairies.find((({codename:e})=>"DJMAXSEHRA"===e));o.skillLevel=7,console.log("Fairy DJMAXSEHRA: ",o.skill),gfcore.dolls.forEach((function(e){console.log(e.type+" - "+e.codename,e)}))},get_dolls_by_type:a,get_dolls_by_buildTime:function(e){console.log("Build Time = "+e);try{let l=[];gfcore.dolls.forEach((function(o){o.buildTime===e&&l.push([o.id,o.codename])})),console.log("dolls_by_buildTime = ",l),console.log("dolls_by_buildTime.length = "+l.length),l.length>0&&s(l,void 0,!0)}catch(e){console.error("get_dolls_by_buildTime: Failed:",e)}},reset_html_doll_data:c}}();