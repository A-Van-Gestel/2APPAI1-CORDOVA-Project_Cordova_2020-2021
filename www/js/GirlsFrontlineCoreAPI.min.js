let GirlsFrontlineCoreAPI=function(){const e=["hg","smg","rf","ar","mg","sg"];let o=!1,l="",t="",i=[];$("#tdoll_selection").on("change",(function(){let e=this.value;""!==e&&c(parseInt(e))})),$("#btns_doll_type").children().on("click",(function(){let e=$(this).data("type");$(this).siblings().addBack().removeClass("active"),$(this).addClass("active"),a(e.toLowerCase()),d()})),$("#btnFloat_favorite").on("click",(function(){let e=$("#tdoll_selection").val();null!==e?u(parseInt(e)):console.error("Favorite Button: "+e+" is NaN!")})),$("#tdoll_selection_favorite").on("change",(function(){let e=this.value;""!==e&&c(parseInt(e),!0)})),$("#btns_favorite").children().on("click",(function(){let e=$(this).data("type");$(this).siblings().addBack().removeClass("active"),$(this).addClass("active"),a(e.toLowerCase(),!0),d(!0)})),$("#btnFloat_Unfavorite").on("click",(function(){let e=$("#tdoll_selection_favorite").val();null!==e?f(parseInt(e)):console.error("UnFavorite Button: "+e+" is NaN!")})),$("#tdoll_BuildTime").on("click",(function(){MaterialDateTimePicker.showTimePicker()})),$("#tdoll_selection_BuildTime").on("change",(function(){let e=this.value;""!==e&&c(parseInt(e),void 0,!0)}));let n=function(){$.getScript("https://unpkg.com/girlsfrontline-core/umd/gfcore.min.js").done((function(e,l,t){console.log("GirlsFrontlineCore-API loaded successfully: ",t.status+" - "+l),o=!0,console.log("Loaded - done: loaded_dynamically = ",o),$("#GFLC_API_Loaded").html("<b>GFL-Core API: </b>Loaded"),NetworkState.close_modal(),_init()})).fail((function(e,l,t){console.error("GirlsFrontlineCore-Api failed to load: ",e.status+" - "+t),o=!1,console.log("Loaded - fail: loaded_dynamically = ",o),$("#GFLC_API_Loaded").html("<b>GFL-Core API: </b> "+t)}))},a=function(o="hg",n=!1){try{if(e.includes(o)){let e=[];gfcore.dolls.forEach((function(a){switch(n){case!0:t=o,a.type===o&&i.includes(a.id)&&e.push([a.id,a.codename]);break;default:l=o,a.type===o&&e.push([a.id,a.codename])}})),s(e,n)}}catch(e){console.error("get_dolls_by_type: Failed:",e)}},s=function(e,o=!1,l=!1){let t="";switch(!0){case!0===o:t="#tdoll_selection_favorite";break;case!0===l:t="#tdoll_selection_BuildTime";break;default:t="#tdoll_selection"}$(t).empty().append("<option value='' disabled selected>Choose a T-Doll</option>"),e.forEach((function(e){$(t).append("<option value='"+e[0]+"'>"+e[1]+"</option>")})),$("select").formSelect()},c=function(e,o=!1,l=!1){let t=gfcore.dolls.find((({id:o})=>o===e));BuildTimeOBJ=new Date(1e3*t.buildTime),hours=BuildTimeOBJ.getUTCHours(),minutes=BuildTimeOBJ.getUTCMinutes(),seconds=BuildTimeOBJ.getSeconds(),BuildTimeString=hours.toString().padStart(2,"0")+":"+minutes.toString().padStart(2,"0")+":"+seconds.toString().padStart(2,"0");let i=`\n            <b>Name: </b>${t.codename}<br>\n            <b>ID: </b>${t.id}<br>\n            <b>Type: </b>${t.type.toUpperCase()}<br>\n            <b>Rank: </b>${"&#9734;".repeat(t.rank)}<br>\n            <b>BuildTime: </b>${BuildTimeString}<br>\n            <b>Skins: </b>${t.skins.length}\n        `;switch(!0){case!0===o:$("#Doll_Data_favorite").html(i);break;case!0===l:$("#Doll_Data_BuildTime").html(i);break;default:$("#Doll_Data").html(i)}},d=function(e=!1){let o="\n            <b>Name: </b>No Data<br>\n            <b>ID: </b>No Data<br>\n            <b>Type: </b>No Data<br>\n            <b>Rank: </b>No Data<br>\n            <b>BuildTime: </b>No Data<br>\n            <b>Skins: </b>No Data\n        ";switch(e){case!0:$("#Doll_Data_favorite").html(o);break;default:$("#Doll_Data").html(o)}},r=function(){console.log("Save Favorited T-Dolls to Local Storage"),localStorage.setItem("favorite_doll_ids",JSON.stringify(i))},u=function(e){i.includes(e)?M.toast({html:"T-Doll already Favorited",displayLength:2e3,classes:"grey_gfl"}):(i.push(e),r(),a(t,!0),M.toast({html:"T-Doll Favorited",displayLength:2e3,classes:"grey_gfl"}))},f=function(e){if(confirm("Remove this T-Doll?")){for(let o=0;o<i.length;o++)i[o]===e&&i.splice(o,1);r(),a(t,!0),d(!0),M.toast({html:"T-Doll removed from Favorites",displayLength:2e3,classes:"grey_gfl"})}};return{init:function(){let e=localStorage.getItem("favorite_doll_ids");null!==e&&(i=[],i=JSON.parse(e)),a(),a(void 0,!0)},get_loaded_dynamically:function(){return n(),o},example:function(){const e=gfcore.dolls.find((({codename:e})=>"G36"===e));e.level=70,e.dummyLink=3,e.favor=50,console.log("Doll G36: ",e.stats),e.skins.forEach((function(e){console.log(e.name)}));const o=gfcore.equips.find((({buildTime:e})=>2100===e));console.log("Equipment BT = 2100: ",o.stats);const l=gfcore.fairies.find((({codename:e})=>"DJMAXSEHRA"===e));l.skillLevel=7,console.log("Fairy DJMAXSEHRA: ",l.skill),gfcore.dolls.forEach((function(e){console.log(e.type+" - "+e.codename,e)}))},get_dolls_by_type:a,get_dolls_by_buildTime:function(e){console.log("Build Time = "+e);try{let o=[];gfcore.dolls.forEach((function(l){l.buildTime===e&&o.push([l.id,l.codename])})),console.log("dolls_by_buildTime = ",o),console.log("dolls_by_buildTime.length = "+o.length),o.length>0&&s(o,void 0,!0)}catch(e){console.error("get_dolls_by_buildTime: Failed:",e)}}}}();